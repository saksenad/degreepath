<?php

ini_set('display_errors', 'On');
error_reporting(E_ALL | E_STRICT);


/* Require Slim Framework */
require_once 'Slim/Slim.php';
/* Require Smarty template engine and Slim Views */
require_once 'Slim/View.php';
require_once 'Slim/Views/Smarty.php';

require_once 'api/courses.php';
require_once 'api/enrollments.php';


$dbhost = "localhost";
$dbuser = "root";
$dbpass = "root";
$dbname = "degreepath";

/* Connect to mysql database */
$conn = mysqli_connect($dbhost, $dbuser, $dbpass) or die ('Error connecting to mysql');
mysqli_select_db($conn, $dbname);

\Slim\Slim::registerAutoloader();

/* Instantiate a Slim application */
$app = new \Slim\Slim(array(
  'view' => new \Slim\Views\Smarty()
));

$app->get('/demo', function() use ($app) {
    $courses = getCourses('SPAN');
    $terms = array('0' => '201308', '1' => '201401', '2' => '201408', '3' => '201501');
    $enrollments = getEnrollments(1);
    $app->render('index.tpl', array(
      'courses' => $courses,
      'terms' => $terms,
      'enrollments' => $enrollments
    ));
});

$app->run();

?>
